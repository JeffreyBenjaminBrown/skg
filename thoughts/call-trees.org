* render_initial_forest_bfs <- single|multi_root_view
  26 LOC
** stub_forest_from_root_ids
   14 LOC
*** build_node_branch_minus_content
    29 LOC
**** skgnode_and_orgnode_from_id
     12 LOC
***** pid_and_source_from_id
      49 LOC
***** skgnode_and_orgnode_from_pid_and_source
      23 LOC
****** path_from_pid_and_source
       16 LOC
****** read_skgnode
       25 LOC
**** TODO complete_branch_minus_content
     12 LOC
***** mark_visited_or_repeat_or_cycle
      23 LOC
****** get_pid_in_pairtree
       10 LOC
****** detect_and_mark_cycle
       13 LOC
******* DUP get_pid_in_pairtree
******* is_ancestor_id
        17 LOC
****** rewrite_to_indefinitive
       10 LOC
       indefinitive = true, body = None
***** maybe_add_subscribee_col
      103 LOC
      If the node: - subscribes to something
                   - is definitive
                   - doesn't have a SubscribeeCol child
****** hidden_ids_in_subscribee_content
       43 LOC
** render_generation_and_recurse
   40 LOC
*** collect_rels_to_children_from_generation
    12 LOC
**** content_ids_if_definitive_else_empty
     15 LOC
*** add_children_and_collect_their_ids
    15 LOC
**** DUP build_node_branch_minus_content
*** REC render_generation_and_recurse
*** add_last_generation_and_truncate_some_of_previous
    30 LOC
**** make_and_append_child_pair
     19 LOC
***** DUP skgnode_and_orgnode_from_id
**** DUP rewrite_to_indefinitive
**** truncate_after_node_in_generation_in_tree
     15 LOC
***** nodes_after_in_generation
      16 LOC
****** collect_generation_ids
       26 LOC
***** DUP collect_generation_ids
***** DUP rewrite_to_indefinitive
* update_from_and_rerender_buffer
  58 LOC
** buffer_to_orgnode_forest_and_save_instructions
   47 LOC
*** org_to_uninterpreted_nodes
    29 LOC
**** divide_into_orgNodeLineCols
     35 LOC
     boring
***** headline_to_triple
      52 LOC
****** find_sexp_end
       15 LOC
****** parse_metadata_to_orgnodemd
       52 LOC
******* parse_view_sexp
        27 LOC
******* parse_code_sexp
        45 LOC
******* parse_rels_sexp
        41 LOC
******* parse_viewrequests_sexp
        18 LOC
**** linecol_to_orgnode
     20 LOC
*** add_missing_info_to_forest
    29 LOC
**** add_missing_info_dfs
     38 LOC
***** assign_alias_relation_if_needed
      7 LOC
***** inherit_source_if_needed
      6 LOC
***** assign_new_id_if_needed
      7 LOC
***** REC add_missing_info_dfs
**** collect_ids_in_tree
     12 LOC
***** REC collect_ids_in_tree
**** pids_from_ids
     83 LOC
**** assign_pids_throughout_tree_from_map
     23 LOC
***** REC assign_pids_throughout_tree_from_map
*** find_buffer_errors_for_saving
    38 LOC
    call tree omitted
*** orgnodes_to_reconciled_save_instructions
    19 LOC
**** saveinstructions_from_forest
     9 LOC
***** saveinstructions_from_tree
      54 LOC
****** skgnode_for_orgnode_in_tree
       31 LOC
******* collect_aliases
        29 LOC
******* collect_contents
        14 LOC
****** REC saveinstructions_from_tree
**** reconcile_same_id_instructions
     15 LOC
***** collect_dup_instructions
      17 LOC
***** reconcile_same_id_instructions_for_one_id
      75 LOC
****** skgnode_and_source_from_id_optional
       17 LOC
******* skgnode_and_source_from_id
        19 LOC
******** DUP pid_and_source_from_id
******** DUP path_from_pid_and_source
**** clobber_none_fields_with_data_from_disk
     44 LOC
*** validate_and_filter_foreign_instructions
    64 LOC
*** instructiontriples_from_the_merges_in_an_orgnode_forest
    16 LOC
**** saveinstructions_from_the_merge_in_an_orgnode
     55 LOC
***** create_acquiree_text_preserver
      12 LOC
***** three_merged_skgnodes
      59 LOC
****** setlike_vector_subtraction
       10 LOC
*** validate_merges_involve_only_owned_nodes
    31 LOC
** update_graph_minus_merges
   38 LOC
*** update_typedb_from_saveinstructions
    54 LOC
**** delete_nodes_from_pids
     64 LOC
**** create_only_nodes_with_no_ids_present
     38 LOC
***** which_ids_exist
      40 LOC
**** delete_out_links
     25 LOC
**** create_all_relationships
     22 LOC
***** create_relationships_from_node
      52 LOC
****** insert_relationship_from_list
       35 LOC
*** update_fs_from_saveinstructions
    30 LOC
**** delete_all_nodes_from_fs
     24 LOC
**** write_all_nodes_to_fs
     35 LOC
***** write_skgnode
      15 LOC
*** update_index_from_saveinstructions
    29 LOC
**** delete_nodes_from_index
     16 LOC
**** add_documents_to_tantivy_writer
     16 LOC
***** create_documents_from_node
      27 LOC
****** replace_each_link_with_its_label
       25 LOC
**** commit_with_status
     12 LOC
** merge_nodes
   26 LOC
*** merge_nodes_in_typedb
    18 LOC
**** merge_one_node_in_typedb
     100 LOC
***** reroute_relationships_for_merge
      28 LOC
***** drop_relationships_for_merge
      20 LOC
***** reroute_what_acquiree_hides
      53 LOC
****** DUP drop_relationships_for_merge
***** delete_extra_ids_for_node
      33 LOC
***** create_node
      22 LOC
***** DUP create_relationships_from_node
*** merge_nodes_in_fs
    37 LOC
/// PURPOSE: For each MergeInstructionTriple:
///   - write the updated acquirer
///   - write the new acquiree text preserver
///   - delete the acquiree
**** DUP write_skgnode
*** merge_nodes_in_tantivy
    12 LOC
**** DUP update_index_from_saveinstructions
** pair_orgnode_forest_with_save_instructions
   21 LOC
*** pairtree_from_orgnodetree_and_map
**** pair_children_optional_recursive
***** REC pair_children_optional_recursive
** completeAndRestoreForest_collectingViewRequests
   18 LOC
*** completeAndRestoreNode_collectingViewRequests
    40 LOC
**** completeAliasCol
     57 LOC
     Called only if one is present.
     Ensures it has all the aliases,
     and removes any other children.
***** get_aliascol_parent_id
      27 LOC
***** DUP pid_and_source_from_id
***** collect_alias_titles
      21 LOC
***** remove_duplicates_and_false_aliases_handling_focus
      59 LOC
***** orgnode_from_title_and_rel
      7 LOC
**** ensure_skgnode
     21 LOC
***** DUP get_pid_in_pairtree
***** skgnode_and_source_from_id
      19 LOC
****** DUP pid_and_source_from_id
****** DUP path_from_pid_and_source
****** read_skgnode
       25 LOC
**** DUP mark_visited_or_repeat_or_cycle
**** clobberIndefinitiveOrgnode
     17 LOC
     set title, source, body=None
**** TODO completeDefinitiveOrgnode
     84 LOC
     seems to overlap other code
***** DUP maybe_add_subscribee_col
***** categorize_children_by_treatment
      18 LOC
***** extend_content
      16 LOC
****** DUP skgnode_and_orgnode_from_id
***** reorder_children
      27 LOC
**** map_completeAndRestoreNodeCollectingViewRequests_over_children
     16 LOC
***** collect_child_ids
      8 LOC
***** REC completeAndRestoreNode_collectingViewRequests
**** collect_view_requests
     14 LOC
** execute_view_requests
   27 LOC
   Executes all view requests collected by the completion phase.
*** build_and_integrate_aliases_view_then_drop_request
    14 LOC
**** build_and_integrate_aliases
     43 LOC
***** fetch_aliases_from_file
      19 LOC
****** DUP pid_and_source_from_id
****** DUP path_from_pid_and_source
***** DUP orgnode_from_title_and_rel
**** remove_completed_view_request
     15 LOC
*** build_and_integrate_containerward_view_then_drop_request
    14 LOC
**** build_and_integrate_containerward_path
     17 LOC
***** DUP get_pid_in_pairtree
***** path_containerward_to_end_cycle_and_or_branches
      16 LOC
****** path_to_end_cycle_and_or_branches
       48 LOC
******* find_related_nodes
        46 LOC
***** integrate_path_that_might_fork_or_cycle
      31 LOC
****** DUP get_pid_in_pairtree
****** integrate_linear_portion_of_path
       25 LOC
******* find_child_by_id
        11 LOC
******* prepend_indefinitive_child_with_parent_ignores
        19 LOC
******** DUP skgnode_and_orgnode_from_id
******* REC integrate_linear_portion_of_path
****** integrate_branches_in_node
       21 LOC
******* find_children_by_ids
        12 LOC
******* DUP prepend_indefinitive_child_with_parent_ignores
****** integrate_cycle_in_node
       11 LOC
******* DUP prepend_indefinitive_child_with_parent_ignores
**** DUP remove_completed_view_request
*** build_and_integrate_sourceward_view_then_drop_request
    14 LOC
**** build_and_integrate_sourceward_path
     16 LOC
***** DUP get_pid_in_pairtree
***** path_sourceward_to_end_cycle_and_or_branches
      16 LOC
****** DUP path_to_end_cycle_and_or_branches
***** DUP integrate_path_that_might_fork_or_cycle
**** DUP remove_completed_view_request
*** execute_definitive_view_request
    38 LOC
**** TODO make this more like render_initial_forest_bfs
**** DUP get_pid_in_pairtree
**** indefinitize_content_subtree
     36 LOC
***** REC indefinitize_content_subtree
**** rebuild_pair_from_disk_mostly_clobbering_the_org
     28 LOC
***** DUP skgnode_and_orgnode_from_pid_and_source
**** extendDefinitiveSubtreeFromLeaf
     46 LOC
***** DUP content_ids_if_definitive_else_empty
***** add_last_generation_and_truncate_some_of_previous
      30 LOC
****** DUP make_and_append_child_pair
****** DUP rewrite_to_indefinitive
****** truncate_after_node_in_generation_in_tree
       15 LOC
******* DUP nodes_after_in_generation
******* DUP get_pid_in_pairtree
******* DUP rewrite_to_indefinitive
***** DUP build_node_branch_minus_content
***** is_indefinitive
      8 LOC
***** DUP content_ids_if_definitive_else_empty
** DUP set_metadata_relationship_viewdata_in_forest
** DUP orgnode_forest_to_string
* single_root_view
  9 LOC
** multi_root_view
   13 LOC
*** DUP render_initial_forest_bfs
*** set_metadata_relationship_viewdata_in_forest
    15 LOC
**** mapsFromIdForView_from_forest
     15 LOC
***** collect_ids_from_pair_tree
      10 LOC
***** fetch_relationship_data
      23 LOC
****** count_containers
       12 LOC
******* count_relations
        72 LOC
****** count_contents
       12 LOC
******* DUP count_relations
****** count_link_sources
       12 LOC
******* DUP count_relations
****** contains_from_pids
       114 LOC
**** set_metadata_relationships_in_node_recursive
     47 LOC
***** REC set_metadata_relationships_in_node_recursive
*** orgnode_forest_to_string
    27 LOC
**** render_node_subtree_to_org
     13 LOC
***** orgnode_to_text
      35 LOC
****** orgnodemd_to_string
       77 LOC
***** REC render_node_subtree_to_org
* handle_save_buffer_request
  53 LOC
** read_length_prefixed_content
   29 LOC
** DUP update_from_and_rerender_buffer
** format_save_error_as_org
   23 LOC
*** format_buffer_validation_error
    62 LOC
** empty_response_sexp
   12 LOC
** send_response
   7 LOC
